<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人生修复协议 | Life Reset Protocol</title>
    <script src="https://cdn.staticfile.org/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdn.staticfile.org/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.staticfile.org/babel-standalone/7.22.10/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@700&display=swap');
        body { background-color: #fcfaf7; color: #1c1917; font-family: sans-serif; }
        .serif { font-family: 'Noto Serif SC', serif; }
        .card { background: white; border: 1px solid #e7e5e4; border-radius: 1.5rem; transition: all 0.3s ease; }
        textarea { resize: none; border: none; width: 100%; height: 150px; padding: 1rem; border-radius: 1rem; background: #f9f8f6; }
        textarea:focus { outline: 2px solid #1c1917; background: white; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [state, setState] = useState(() => {
                const saved = localStorage.getItem('life-reset-v3');
                return saved ? JSON.parse(saved) : {
                    commitment: false,
                    antiVision: { health: '', finance: '' },
                    identity: ''
                };
            });

            useEffect(() => {
                localStorage.setItem('life-reset-v3', JSON.stringify(state));
            }, [state]);

            const scrollTo = (id) => document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });

            return (
                <div className="max-w-2xl mx-auto px-6 py-10 pb-32">
                    {/* 头部 */}
                    <header className="min-h-[60vh] flex flex-col justify-center items-center text-center">
                        <h1 className="text-5xl font-bold serif mb-6">人生修复协议</h1>
                        <p className="text-stone-400 mb-10 tracking-widest uppercase text-sm">Life Repair Protocol</p>
                        
                        {!state.commitment ? (
                            <button 
                                onClick={() => setState({...state, commitment: true})}
                                className="bg-stone-900 text-white px-10 py-4 rounded-full font-bold shadow-lg hover:bg-stone-800"
                            >
                                签写协议并开始
                            </button>
                        ) : (
                            <button onClick={() => scrollTo('phase-1')} className="text-stone-400 animate-bounce">
                                ⬇ 向下滑动开始修复
                            </button>
                        )}
                    </header>

                    {state.commitment && (
                        <div className="space-y-24 mt-20">
                            {/* 阶段 1 */}
                            <section id="phase-1" className="space-y-8">
                                <h2 className="text-2xl font-bold serif border-b pb-4">01. 反向愿景 (你想逃离什么)</h2>
                                <div className="card p-6 space-y-4">
                                    <label className="text-xs font-bold text-stone-500">健康衰败的代价</label>
                                    <textarea 
                                        value={state.antiVision.health}
                                        onChange={(e) => setState({...state, antiVision: {...state.antiVision, health: e.target.value}})}
                                        placeholder="描述如果你继续挥霍身体，5年后的痛苦状态..."
                                    />
                                </div>
                                <div className="card p-6 space-y-4">
                                    <label className="text-xs font-bold text-stone-500">财务平庸的绝望</label>
                                    <textarea 
                                        value={state.antiVision.finance}
                                        onChange={(e) => setState({...state, antiVision: {...state.antiVision, finance: e.target.value}})}
                                        placeholder="如果你不努力，你将不得不忍受什么样的羞辱？"
                                    />
                                </div>
                                <button onClick={() => scrollTo('phase-2')} className="w-full py-4 bg-stone-100 rounded-full font-bold">
                                    定义新身份 →
                                </button>
                            </section>

                            {/* 阶段 2 */}
                            <section id="phase-2" className="space-y-8">
                                <h2 className="text-2xl font-bold serif border-b pb-4">02. 身份重构 (你是谁)</h2>
                                <div className="card p-8 bg-stone-900">
                                    <label className="text-xs font-bold text-stone-500 mb-4 block">新身份宣言</label>
                                    <textarea 
                                        style={{background: '#1c1917', color: 'white'}}
                                        value={state.identity}
                                        onChange={(e) => setState({...state, identity: e.target.value})}
                                        placeholder="我是那个即便在废墟中也能重建系统的人。"
                                    />
                                </div>
                                <div className="flex gap-4">
                                    <button onClick={() => window.print()} className="flex-1 py-4 bg-stone-900 text-white rounded-full font-bold">
                                        导出 PDF
                                    </button>
                                    <button onClick={() => {localStorage.clear(); location.reload();}} className="px-6 py-4 text-stone-300">
                                        重置
                                    </button>
                                </div>
                            </section>
                        </div>
                    )}

                    {/* 极简导航 */}
                    <nav className="fixed bottom-6 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur-md border border-stone-200 px-6 py-3 rounded-full flex gap-6 text-[10px] font-bold text-stone-400 tracking-widest shadow-xl">
                        <button onClick={() => window.scrollTo({top: 0, behavior: 'smooth'})}>TOP</button>
                        <button onClick={() => scrollTo('phase-1')}>VISION</button>
                        <button onClick={() => scrollTo('phase-2')}>IDENTITY</button>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
