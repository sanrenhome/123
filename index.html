<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äººç”Ÿä¿®å¤æŒ‡å— Â· 2026æ–°ç”Ÿä»£ç </title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        :root {
            --bg: #050505;
            --surface: #121214;
            --primary: #ff2a85;
            --secondary: #b72aff;
            --accent: #00f0ff;
            --text-main: #ffffff;
            --text-muted: #888899;
            --gold: #ffd700;
            --border: rgba(255,255,255,0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Noto Sans SC', sans-serif; -webkit-tap-highlight-color: transparent; }

        body { background: #000; display: flex; justify-content: center; color: var(--text-main); line-height: 1.6; overflow: hidden; }

        #app { width: 100%; max-width: 480px; height: 100dvh; background: var(--bg); position: relative; overflow-y: auto; overflow-x: hidden; scroll-behavior: smooth; }
        
        /* éšè—æ»šåŠ¨æ¡ */
        #app::-webkit-scrollbar { display: none; }

        /* é¡µé¢åˆ‡æ¢åŠ¨ç”» */
        .page { display: none; padding: 30px 20px; animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; min-height: 100%; }
        .page.active { display: block; }

        @keyframes fadeUp {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* æ ‡é¢˜ä¸å‘å…‰å­— */
        h1 { font-size: 28px; font-weight: 900; margin-bottom: 10px; line-height: 1.2; }
        .glow-text {
            background: linear-gradient(to right, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text; color: transparent;
            text-shadow: 0 0 20px rgba(255,42,133,0.3);
        }
        .subtitle { color: var(--text-muted); font-size: 14px; margin-bottom: 30px; }

        /* æŒ‰é’®ä¸è¡¨å• */
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white; border: none; padding: 16px; width: 100%; border-radius: 12px;
            font-size: 16px; font-weight: 700; margin-top: 20px; cursor: pointer;
            box-shadow: 0 8px 25px rgba(183, 42, 255, 0.4); transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.98); }
        .btn-outline {
            background: transparent; border: 1px solid var(--secondary);
            box-shadow: none; color: var(--secondary); margin-top: 10px;
        }

        input[type="text"], textarea {
            width: 100%; background: var(--surface); border: 1px solid var(--border);
            color: white; padding: 14px; border-radius: 8px; margin-bottom: 15px; font-size: 14px;
            outline: none; transition: border-color 0.3s;
        }
        input[type="text"]:focus, textarea:focus { border-color: var(--secondary); }

        /* é€‰é¡¹å¡ç‰‡ (å¤šé€‰/å•é€‰) */
        .choice-card {
            background: var(--surface); border: 1px solid var(--border);
            border-radius: 10px; padding: 15px; margin-bottom: 12px;
            cursor: pointer; transition: all 0.3s; font-size: 14px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .choice-card.selected {
            border-color: var(--primary); background: rgba(255,42,133,0.1);
            box-shadow: 0 0 15px rgba(255,42,133,0.2);
        }

        /* è¿›åº¦æ¡ */
        .progress-bar { position: fixed; top: 0; left: 0; width: 100%; height: 3px; background: #222; z-index: 100; max-width: 480px; left: 50%; transform: translateX(-50%); }
        .progress-fill { height: 100%; background: linear-gradient(to right, var(--primary), var(--accent)); width: 0%; transition: width 0.4s; }

        /* è¯ä¹¦ç”ŸæˆåŒº */
        #cert-capture {
            background: radial-gradient(circle at top right, #2a0845, #000000);
            padding: 40px 20px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            position: relative; overflow: hidden; margin-bottom: 20px;
        }
        #cert-capture::before {
            content: ''; position: absolute; top: -50px; left: -50px; width: 150px; height: 150px;
            background: var(--primary); filter: blur(100px); opacity: 0.3;
        }
        .cert-header { display: flex; justify-content: space-between; margin-bottom: 30px; font-size: 12px; color: var(--text-muted); }
        .rarity-badge {
            display: inline-block; padding: 5px 12px; border-radius: 20px;
            font-weight: 900; font-size: 14px; letter-spacing: 2px;
            background: linear-gradient(135deg, #ffd700, #ff8c00); color: #000; box-shadow: 0 0 20px rgba(255,215,0,0.4);
        }
        .cert-code { font-size: 64px; font-weight: 900; letter-spacing: 5px; margin: 20px 0; background: linear-gradient(to bottom, #fff, #aaa); -webkit-background-clip: text; color: transparent; text-align: center; }
        .cert-tag-wall { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 20px; }
        .cert-tag { background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 4px; font-size: 12px; color: #ccc; }
        .watermark { margin-top: 40px; border-top: 1px dashed rgba(255,255,255,0.2); padding-top: 15px; text-align: center; font-size: 10px; color: #666; display: flex; justify-content: space-between;}

        /* åˆ†äº«æ–‡æ¡ˆæ¡† */
        .share-box { background: var(--surface); padding: 15px; border-radius: 8px; font-size: 13px; color: #ccc; margin-bottom: 10px; position: relative; }
        select { width: 100%; background: transparent; color: var(--accent); border: none; margin-bottom: 10px; outline: none; font-weight: bold; }

        /* Toast æç¤º */
        .toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: white; color: black; padding: 10px 20px; border-radius: 30px; font-weight: bold; font-size: 14px; opacity: 0; pointer-events: none; transition: opacity 0.3s; z-index: 999; }
    </style>
</head>
<body>

    <div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
    <div class="toast" id="toast">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>

    <div id="app">
        <div class="page active" id="page-1">
            <h1 style="margin-top: 15vh;"><span class="glow-text">äººç”Ÿä¿®å¤æŒ‡å—</span><br>2026 æ–°ç”Ÿä»£ç </h1>
            <p class="subtitle">ä½ ä¸æ˜¯åœ¨æ‹–å»¶ï¼Œä½ åªæ˜¯åœ¨ä¿æŠ¤é‚£ä¸ªå¹³åº¸çš„è‡ªå·±ã€‚<br>åŸºäºDan Koeâ€œåå‘æ„¿æ™¯â€ç†è®ºçš„æ·±åº¦è‡ªçœã€‚</p>
            <div style="height: 40px;"></div>
            <p style="font-size: 14px; margin-bottom: 10px; color: var(--text-muted);">è¯·è¾“å…¥ä½ çš„ä»£å·ï¼ˆé€‰å¡«ï¼‰</p>
            <input type="text" id="nickname" placeholder="ä¾‹å¦‚ï¼šNeo" maxlength="10">
            <button class="btn" onclick="goPage(2)">å¯åŠ¨æ¸…ç†ç¨‹åºï¼Œç›´é¢çœŸç›¸</button>
            <p style="text-align: center; margin-top: 20px; font-size: 12px; color: #555;">âš ï¸ è­¦å‘Šï¼šåŒ…å«è½»å¾®æ‰å¿ƒå†…å®¹ï¼Œç»ç’ƒå¿ƒæ…å…¥ã€‚</p>
        </div>

        <div class="page" id="page-2">
            <h1>æ„å»ºä½ çš„<span class="glow-text">åå‘æ„¿æ™¯</span></h1>
            <p class="subtitle">äººç±»æ”¹å˜çš„åŠ¨åŠ›ï¼Œé€ƒç¦»ç—›è‹¦è¿œå¤§äºè¿½æ±‚å¿«ä¹ã€‚é€‰å‡ºä½ æœ€æ¶å¿ƒçš„æœªæ¥ï¼ˆå¤šé€‰ï¼‰ï¼š</p>
            
            <div id="antivision-list">
                </div>

            <textarea id="worst-fear" rows="3" placeholder="ç”¨ä¸€å¥è¯æ€»ç»“ï¼šå¦‚æœä¸æ”¹å˜ï¼Œä½ æœ€æ€•å˜æˆä»€ä¹ˆæ ·ï¼Ÿï¼ˆ50å­—å†…ï¼‰"></textarea>
            
            <button class="btn-outline btn" onclick="copyAIPrompt()">ğŸ¤– AIè¾…åŠ©ï¼šç”Ÿæˆæˆ‘çš„æ·±åº¦å‰–æè¯</button>
            <button class="btn" onclick="goPage(3)">å¤Ÿäº†ï¼Œæˆ‘ä¸æƒ³å˜æˆè¿™æ ·</button>
        </div>

        <div class="page" id="page-3">
            <h1>é‡å¡‘<span class="glow-text">æ–°èº«ä»½</span></h1>
            <p class="subtitle">è¡Œä¸ºæ˜¯èº«ä»½çš„å‰¯äº§å“ã€‚åˆ«è¯´â€œæˆ‘è¦å‡è‚¥â€ï¼Œè¯´â€œæˆ‘æ˜¯è¿åŠ¨å‘˜â€ã€‚é€‰æ‹©ä½ æ¸´æœ›çš„ç‰¹è´¨ï¼š</p>
            
            <p style="margin-top: 15px; color: var(--accent); font-size: 12px;">ç»´åº¦ I : æ³¨æ„åŠ›æµå‘</p>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim1', 'C')">
                <span>åˆ›ä½œè€…æ¨¡å¼ (Creator)</span><span style="font-size:10px;color:#888;">è¾“å‡º>è¾“å…¥</span>
            </div>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim1', 'O')">
                <span>è§‚å¯Ÿè€…æ¨¡å¼ (Observer)</span><span style="font-size:10px;color:#888;">æ·±åº¦è§£æä¸–ç•Œ</span>
            </div>

            <p style="margin-top: 15px; color: var(--accent); font-size: 12px;">ç»´åº¦ II : ä»·å€¼å¼•æ“</p>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim2', 'B')">
                <span>æ„å»ºè€… (Builder)</span><span style="font-size:10px;color:#888;">æ‰“é€ ç³»ç»Ÿä¸äº§å“</span>
            </div>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim2', 'C')">
                <span>è¿æ¥è€… (Connector)</span><span style="font-size:10px;color:#888;">é“¾æ¥èµ„æºä¸äººè„‰</span>
            </div>

            <p style="margin-top: 15px; color: var(--accent); font-size: 12px;">ç»´åº¦ III : ç ´å±€æ­¦å™¨</p>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim3', 'F')">
                <span>ç»å¯¹ä¸“æ³¨ (Focus)</span><span style="font-size:10px;color:#888;">æ¯å¤©æ·±åº¦å·¥ä½œ2å°æ—¶</span>
            </div>
            <div class="choice-card single-choice" onclick="selectRadio(this, 'dim3', 'R')">
                <span>æç®€ä¸»ä¹‰ (Reduce)</span><span style="font-size:10px;color:#888;">ç æ‰90%æ— ç”¨æ¬²æœ›</span>
            </div>

            <button class="btn" onclick="checkAndGo(4)">æå–æˆ‘çš„æ–°ç”Ÿä»£ç </button>
        </div>

        <div class="page" id="page-4">
            <h1>å»ºç«‹<span class="glow-text">å¼ºåˆ¶æœºåˆ¶</span></h1>
            <p class="subtitle">åŠ¨æœºæ˜¯ä¸å¯é çš„ï¼Œç³»ç»Ÿæ‰æ˜¯ç‹é“ã€‚è®¾å®šä½ çš„1æ­¥è¡ŒåŠ¨ï¼š</p>

            <p style="font-size: 13px; margin-bottom: 8px;">1. æŠ›å¼€é‡‘é’±ï¼Œä½ ç°åœ¨æœ€æƒ³ä¸“æ³¨çš„äº‹ï¼š</p>
            <input type="text" id="focus-thing" placeholder="ä¾‹å¦‚ï¼šå†™å®Œæˆ‘çš„ä¸ªäººç½‘ç«™">

            <p style="font-size: 13px; margin-bottom: 8px;">2. æ¯æ—¥çš„é›·æ‰“ä¸åŠ¨ä»ªå¼ï¼ˆæå¾®å°ï¼‰ï¼š</p>
            <input type="text" id="daily-ritual" placeholder="ä¾‹å¦‚ï¼šæ—©èµ·å–æ°´åå…ˆå†™100å­—">

            <p style="font-size: 13px; margin-bottom: 8px;">3. å¤±è´¥æƒ©ç½š/å¼ºåˆ¶ç»‘å®šæœºåˆ¶ï¼š</p>
            <input type="text" id="punishment" placeholder="ä¾‹å¦‚ï¼šåšä¸åˆ°å°±ç»™æ­»å¯¹å¤´æ‰“100å—">

            <button class="btn" onclick="generateFinal()">ç”Ÿæˆæˆ‘çš„ä¸“å±è¯ä¹¦</button>
            <button class="btn-outline btn" onclick="generateFinal()" style="border:none; color:#666; margin-top:0;">è·³è¿‡ï¼Œç›´æ¥çœ‹ä»£ç </button>
        </div>

        <div class="page" id="page-5">
            <div id="cert-capture">
                <div class="cert-header">
                    <span>STATUS: AWAKENED</span>
                    <span id="cert-date">2026.XX.XX</span>
                </div>
                
                <p style="font-size: 14px; color: #aaa;">IDENTIFICATION CODE</p>
                <div class="cert-code" id="final-code">X-0000</div>
                
                <div style="text-align: center;">
                    <span class="rarity-badge" id="cert-rarity">å²è¯—çº§ EPIC</span>
                </div>

                <div class="cert-tag-wall">
                    <div class="cert-tag" id="tag-name">ç”¨æˆ·ï¼šæœªçŸ¥</div>
                    <div class="cert-tag">æ‹’ç»å¹³åº¸</div>
                    <div class="cert-tag">åå‘æ„¿æ™¯é©±åŠ¨</div>
                    <div class="cert-tag" id="tag-focus">ä¸“æ³¨åŠ›é”å®š</div>
                </div>

                <div style="margin-top: 25px; padding: 15px; background: rgba(0,0,0,0.5); border-radius: 8px;">
                    <p style="font-size: 12px; color: #fff; font-style: italic;">"æˆ‘ä¸æƒ³å˜æˆè¿™æ ·ï¼š"</p>
                    <p style="font-size: 12px; color: var(--primary); margin-top: 5px;" id="cert-fear">æ¯å¤©åˆ·çŸ­è§†é¢‘åˆ°å‡Œæ™¨ï¼Œç¬¬äºŒå¤©ç»§ç»­åæ‚”ã€‚</p>
                </div>

                <div class="watermark">
                    <span>æ‰«æå¯»æ‰¾å±äºä½ çš„ä»£ç </span>
                    <span>äººç”Ÿä¿®å¤æŒ‡å— Â· Dan Koe</span>
                </div>
            </div>

            <p style="font-size: 14px; font-weight: bold; margin-top: 20px;">é€‰æ‹©ä½ çš„æœ‹å‹åœˆæ–‡æ¡ˆï¼š</p>
            <div class="share-box">
                <select id="share-tone" onchange="updateShareText()">
                    <option value="ruthless">ç‹ äººå®£è¨€ (æ¨è)</option>
                    <option value="versailles">å‡¡å°”èµ› (ç‚«è€€)</option>
                    <option value="gentle">è‡ªçœæ²»æ„ˆ (æ¸©æŸ”)</option>
                </select>
                <p id="share-text">å¦‚æœä¸æƒ³å†è¢«å¹³åº¸æ¶å¿ƒï¼Œå°±äº²æ‰‹å¹²æ‰è¿‡å»çš„è‡ªå·±ã€‚æˆ‘çš„æ–°ç”Ÿä»£ç æ˜¯[X-0000]ï¼ŒæŠ½åˆ°äº†å…¨ç½‘ä»…20%çš„å²è¯—çº§ã€‚è°æ¥ç¢°ç¢°è¿æ°”ï¼Ÿ</p>
            </div>

            <button class="btn" onclick="downloadCert()">ğŸ“¸ ä¸€é”®ä¿å­˜è¯ä¹¦ï¼Œå‘ä¸ªæœ‹å‹åœˆ</button>
            <button class="btn-outline btn" onclick="copyShareText()">ğŸ“ å¤åˆ¶æ–‡æ¡ˆ</button>
            <div style="height: 50px;"></div>
        </div>
    </div>

    <script>
        // æ•°æ®é…ç½®
        const antivisionOptions = [
            "æ¯å¤©åˆ·çŸ­è§†é¢‘åˆ°å‡Œæ™¨ï¼Œç¬¬äºŒå¤©ä¾ç„¶ç©ºè™šåæ‚”",
            "æ”¶è—å¤¹é‡Œæœ‰1000ä¸ªå¹²è´§ï¼Œè„‘å­ä¾ç„¶ç©ºç©ºå¦‚ä¹Ÿ",
            "ä¸€è¾¹å«‰å¦’åŒé¾„äººæé’±ï¼Œä¸€è¾¹è¿æ—©èµ·éƒ½åšä¸åˆ°",
            "æ€»è§‰å¾—â€œæ˜å¤©â€ä¼šæœ‰å¥‡è¿¹ï¼Œç»“æœè¿‡äº†3å¹´ä¸€æ¨¡ä¸€æ ·çš„ç”Ÿæ´»",
            "å˜æˆæ»¡è‚šå­ç‰¢éªšï¼Œåªä¼šæŠ±æ€¨å¤§ç¯å¢ƒçš„ä¸­å¹´äºº",
            "å› ä¸ºæ²¡é’±ï¼Œé¢å¯¹å–œæ¬¢çš„äººå’Œäº‹ç‰©åªèƒ½è¯´â€œç®—äº†â€"
        ];

        let state = {
            nickname: '',
            fear: '',
            codeStr: '',
            rarityLevel: '',
            rarityColor: ''
        };

        // åˆå§‹åŒ–
        window.onload = () => {
            const list = document.getElementById('antivision-list');
            antivisionOptions.forEach((opt, index) => {
                const div = document.createElement('div');
                div.className = 'choice-card multi-choice';
                div.innerHTML = `<span>${opt}</span><span style="font-size:18px; color:#555;">+</span>`;
                div.onclick = function() {
                    this.classList.toggle('selected');
                    const span = this.querySelector('span:last-child');
                    span.innerText = this.classList.contains('selected') ? 'âœ“' : '+';
                    span.style.color = this.classList.contains('selected') ? 'var(--primary)' : '#555';
                };
                list.appendChild(div);
            });
            updateProgress(1);
        };

        // é¡µé¢å¯¼èˆª
        function goPage(pageNum) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageNum}`).classList.add('active');
            updateProgress(pageNum);
            document.getElementById('app').scrollTo(0,0);
        }

        function updateProgress(num) {
            const total = 5;
            document.getElementById('progress').style.width = `${(num / total) * 100}%`;
        }

        // å•é€‰é€»è¾‘
        function selectRadio(el, group, val) {
            // æ¸…é™¤åŒç»„é€‰ä¸­çŠ¶æ€
            el.parentElement.querySelectorAll('.single-choice').forEach(card => {
                if(card.getAttribute('onclick').includes(group)) {
                    card.classList.remove('selected');
                }
            });
            el.classList.add('selected');
            el.dataset.val = val;
        }

        function checkAndGo(pageNum) {
            // ç®€å•çš„æ ¡éªŒï¼šç¡®ä¿é€‰äº†ä¸‰ä¸ªç»´åº¦çš„ç‰¹å¾
            const d1 = document.querySelector(`.choice-card.selected[onclick*="dim1"]`);
            const d2 = document.querySelector(`.choice-card.selected[onclick*="dim2"]`);
            const d3 = document.querySelector(`.choice-card.selected[onclick*="dim3"]`);
            
            if(!d1 || !d2 || !d3) {
                showToast("è¯·å®Œæˆèº«ä»½ç»´åº¦çš„é€‰æ‹©");
                return;
            }
            state.codeStr = (d1.dataset.val + d2.dataset.val + d3.dataset.val).toUpperCase() + "-" + Math.floor(Math.random()*99 + 10);
            goPage(pageNum);
        }

        // ç”Ÿæˆæœ€ç»ˆç»“æœ
        function generateFinal() {
            state.nickname = document.getElementById('nickname').value || 'åŒ¿åè€…';
            let customFear = document.getElementById('worst-fear').value;
            if(!customFear) {
                const selected = document.querySelector('.multi-choice.selected span');
                state.fear = selected ? selected.innerText : "åœ¨å¹³åº¸ä¸­åº¦è¿‡ä¸€ç”Ÿï¼Œæ²¡æœ‰ç•™ä¸‹ä»»ä½•ç—•è¿¹ã€‚";
            } else {
                state.fear = customFear;
            }

            // ç¨€æœ‰åº¦ç®—æ³•
            const rand = Math.random();
            if(rand < 0.05) { // 5%
                state.rarityLevel = "ä¼ è¯´çº§ LEGENDARY";
                state.rarityColor = "linear-gradient(135deg, #ffd700, #ff8c00)";
            } else if(rand < 0.25) { // 20%
                state.rarityLevel = "å²è¯—çº§ EPIC";
                state.rarityColor = "linear-gradient(135deg, var(--secondary), var(--primary))";
            } else { // 75%
                state.rarityLevel = "ç¨€æœ‰çº§ RARE";
                state.rarityColor = "linear-gradient(135deg, #00f0ff, #0055ff)";
            }

            // æ¸²æŸ“æ•°æ®åˆ°è¯ä¹¦
            const d = new Date();
            document.getElementById('cert-date').innerText = `${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')}`;
            document.getElementById('final-code').innerText = state.codeStr;
            const badge = document.getElementById('cert-rarity');
            badge.innerText = state.rarityLevel;
            badge.style.background = state.rarityColor;
            
            document.getElementById('tag-name').innerText = `ID: ${state.nickname}`;
            
            let userFocus = document.getElementById('focus-thing').value;
            document.getElementById('tag-focus').innerText = userFocus ? `æ ¸å¿ƒç›®æ ‡:${userFocus.substring(0,6)}` : "ä¸“æ³¨åŠ›é”å®š";
            
            document.getElementById('cert-fear').innerText = state.fear;

            updateShareText();
            goPage(5);
            triggerConfetti();
        }

        // ç²’å­ç‰¹æ•ˆ
        function triggerConfetti() {
            var duration = 3 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) { return Math.random() * (max - min) + min; }

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        // è¾…åŠ©åŠŸèƒ½
        function updateShareText() {
            const type = document.getElementById('share-tone').value;
            let text = "";
            let r = state.rarityLevel.split(" ")[0];
            if(type === 'ruthless') {
                text = `å¦‚æœä¸æƒ³å†è¢«å¹³åº¸æ¶å¿ƒï¼Œå°±äº²æ‰‹å¹²æ‰è¿‡å»çš„è‡ªå·±ã€‚æˆ‘çš„æ–°ç”Ÿä»£ç æ˜¯ã€${state.codeStr}ã€‘ï¼Œå±…ç„¶æŠ½åˆ°äº†å…¨ç½‘ä»…æœ‰çš„${r}ã€‚è°æ•¢æ¥ç¢°ç¢°è¿æ°”ï¼Ÿ`;
            } else if (type === 'versailles') {
                text = `éšä¾¿åšäº†ä¸€ä¸ªæ·±åº¦å¿ƒç†æµ‹è¯•ï¼Œä¸€ä¸å°å¿ƒæŠ½åˆ°äº†ã€${r}ã€‘è§‰é†’èº«ä»½ï¼ˆä»£ç ${state.codeStr}ï¼‰ã€‚2026ä¸è£…äº†ï¼Œæˆ‘è¦æ‹¿å›å±äºæˆ‘çš„ä¸€åˆ‡ã€‚`;
            } else {
                text = `ä»Šå¤©åšäº†ä¸€ä¸ªåŸºäºDan Koeçš„å¿ƒç†æ¸…ç†ã€‚ç›´é¢ä¸å ªï¼Œç„¶åé‡æ–°å‡ºå‘ã€‚æˆ‘çš„æ–°ç”Ÿä»£ç æ˜¯${state.codeStr}ï¼Œæ„¿æˆ‘ä»¬éƒ½åœ¨è¡ŒåŠ¨ä¸­è¢«æ²»æ„ˆã€‚`;
            }
            document.getElementById('share-text').innerText = text;
        }

        function copyShareText() {
            const text = document.getElementById('share-text').innerText;
            navigator.clipboard.writeText(text).then(() => showToast("æ–‡æ¡ˆå·²å¤åˆ¶ï¼Œå¿«å»å‘æœ‹å‹åœˆå§ï¼"));
        }

        function copyAIPrompt() {
            const text = `æˆ‘æ­£åœ¨è¿›è¡Œè‡ªæˆ‘æå‡çš„ç ´å±€æ€è€ƒã€‚æˆ‘æœ€å®³æ€•çš„æœªæ¥æ˜¯ï¼š"${document.getElementById('worst-fear').value || 'æ¯å¤©ç¢Œç¢Œæ— ä¸ºï¼Œè¢«æ—¶ä»£æŠ›å¼ƒ'}"ã€‚è¯·æ‰®æ¼”ä¸€ä¸ªåƒDan Koeä¸€æ ·çŠ€åˆ©ã€ç›´å‡»æœ¬è´¨çš„å¿ƒç†æˆé•¿å¯¼å¸ˆï¼Œç»™æˆ‘ä¸€æ®µä¸åˆ°150å­—çš„è¯ï¼Œç‹ ç‹ åœ°éª‚é†’æˆ‘ï¼Œå¹¶ç»™æˆ‘ä¸€ä¸ªå…·ä½“ä¸”æç®€çš„è¡ŒåŠ¨å»ºè®®ã€‚`;
            navigator.clipboard.writeText(text).then(() => showToast("æç¤ºè¯å·²å¤åˆ¶ï¼è¯·å»ä»»æ„AIå·¥å…·ï¼ˆå¦‚Kimi/ChatGPTï¼‰ç²˜è´´å‘é€"));
        }

        // å›¾ç‰‡å¯¼å‡º
        function downloadCert() {
            const cert = document.getElementById('cert-capture');
            const btn = document.querySelector('button[onclick="downloadCert()"]');
            btn.innerText = "ç”Ÿæˆä¸­...è¯·ç¨å€™";
            btn.style.opacity = 0.7;

            html2canvas(cert, {
                scale: 2, // æé«˜æ¸…æ™°åº¦
                backgroundColor: "#000000",
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `æ–°ç”Ÿä»£ç _${state.codeStr}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                btn.innerText = "ğŸ“¸ ä¿å­˜æˆåŠŸï¼å¿«å»åˆ†äº«å§";
                btn.style.opacity = 1;
                setTimeout(() => { btn.innerText = "ğŸ“¸ ä¸€é”®ä¿å­˜è¯ä¹¦ï¼Œå‘ä¸ªæœ‹å‹åœˆ"; }, 3000);
            }).catch(err => {
                showToast("ç”Ÿæˆå¤±è´¥ï¼Œè¯·æˆªå›¾ä¿å­˜");
                btn.innerText = "ğŸ“¸ ä¸€é”®ä¿å­˜è¯ä¹¦ï¼Œå‘ä¸ªæœ‹å‹åœˆ";
                btn.style.opacity = 1;
            });
        }

        // Toast
        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.opacity = 1;
            setTimeout(() => { t.style.opacity = 0; }, 2500);
        }
    </script>
</body>
</html>
