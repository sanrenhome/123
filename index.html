<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>一天人生重启工作台 - 精简深度版 v2</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f9fafb;
      color: #111827;
      line-height: 1.7;
      margin: 0;
      padding: 20px;
    }
    .container { max-width: 680px; margin: 0 auto; }
    h1 { text-align: center; color: #1e40af; margin-bottom: 0.4em; }
    .progress-container {
      margin: 1em 0 2em;
      background: #e5e7eb;
      border-radius: 999px;
      height: 8px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      transition: width 0.4s ease;
    }
    .section {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 1.8em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      transition: all 0.3s;
    }
    .section.completed {
      background: #ecfdf5;
      border-color: #a7f3d0;
    }
    h2 {
      color: #1e40af;
      margin: 0 0 1.2em;
      font-size: 1.4em;
    }
    label {
      display: block;
      margin: 1.4em 0 0.4em;
      font-weight: 600;
      color: #374151;
    }
    textarea {
      width: 100%;
      min-height: 80px;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 1.05em;
      resize: vertical;
    }
    .tip {
      font-size: 0.9em;
      color: #6b7280;
      margin: 0.4em 0 0.8em;
    }
    .ai-btn {
      background: #e0f2fe;
      color: #1d4ed8;
      border: 1px solid #bfdbfe;
      padding: 6px 14px;
      border-radius: 6px;
      font-size: 0.9em;
      cursor: pointer;
      margin: 0.6em 0;
    }
    .ai-btn:hover { background: #dbeafe; }
    .btn {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 12px 28px;
      border-radius: 8px;
      font-size: 1.05em;
      cursor: pointer;
      margin: 1.5em 1em 0.5em 0;
    }
    .btn:hover { background: #2563eb; }
    .btn-primary { background: #10b981; }
    .btn-primary:hover { background: #059669; }
    #status { text-align: center; color: #4b5563; margin: 1em 0; font-weight: 500; }
  </style>
</head>
<body>

<div class="container">
  <h1>一天人生重启工作台</h1>
  <p style="text-align:center; color:#6b7280; margin-bottom:1.5em;">
    每题≤100字 · 支持AI辅助 · 总时长约2–3小时
  </p>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div id="status">进度：0%（共4阶段）</div>

  <div class="section" id="section0">
    <h2>开始前</h2>
    <p>今天日期：<input type="date" id="todayDate"></p>
    <label>
      <input type="checkbox" id="quickMode"> 快速模式（只做3个核心问题，约30分钟）
    </label>
    <label>
      <input type="checkbox" id="promise" checked> 我愿意认真回答每个问题
    </label>
    <button class="btn" onclick="start()">开始重启</button>
  </div>

  <div class="section" id="section1" style="display:none;">
    <h2>1. 看见最不想成为的自己</h2>
    <label>5年后最让你崩溃的身体/生活状态（一句话或短描述）：</label>
    <textarea id="anti1" maxlength="200" placeholder="例：每天靠药活着，走路都费劲……"></textarea>
    <button class="ai-btn" onclick="suggestAI(1)">AI帮我写得更真实</button>

    <label>最孤独/最空虚的一天会是怎样的？（一句话）</label>
    <textarea id="anti2" maxlength="200"></textarea>

    <label>拖延的根源：我在保护的那个“旧我”是什么角色？（一句话）</label>
    <textarea id="root1" maxlength="120"></textarea>
    <button class="ai-btn" onclick="suggestAI('root')">AI帮我挖根源</button>

    <button class="btn" onclick="completeStage(1)">完成阶段1</button>
  </div>

  <div class="section" id="section2" style="display:none;">
    <h2>2. 我真正想成为的人</h2>
    <label>理想的我，每天会自然做的3–5件小事（每条一句话）</label>
    <textarea id="new1" maxlength="300" placeholder="例：1. 早上先写500字 2. 拒绝无效会议……"></textarea>

    <label>从今天起，我是谁？（写1–3句“我是……”）</label>
    <textarea id="new2" maxlength="200"></textarea>
    <button class="ai-btn" onclick="suggestAI('identity')">AI帮我润色宣言</button>

    <label>真正想做的一件事（最让你兴奋的那个，1–2句）</label>
    <textarea id="new3" maxlength="150"></textarea>

    <button class="btn" onclick="completeStage(2)">完成阶段2</button>
  </div>

  <div class="section" id="section3" style="display:none;">
    <h2>3. 简单可执行计划</h2>
    <label>最重要的一件事（1周内必须启动的）：</label>
    <textarea id="plan1" maxlength="150"></textarea>

    <label>每天最关键的仪式（一句话，早或晚）</label>
    <textarea id="plan2" maxlength="100"></textarea>

    <label>我会用什么方式逼自己完成？（选一个或写一个）</label>
    <textarea id="plan3" maxlength="150" placeholder="例：发朋友圈公开承诺 + 没完成捐款50元"></textarea>

    <button class="btn" onclick="completeStage(3)">完成阶段3</button>
  </div>

  <div class="section" id="section4" style="display:none;">
    <h2>已完成！你的重启记录</h2>
    <p>所有内容已保存在浏览器，可随时回来修改。</p>

    <button class="btn btn-primary" onclick="copyAll()">一键复制全部内容</button>
    <button class="btn" onclick="exportImage()">导出为图片保存</button>
    <button class="btn" onclick="saveData()">保存进度</button>

    <div id="preview" style="margin-top:2em; background:#f1f5f9; padding:16px; border-radius:8px; white-space:pre-wrap; font-size:0.95em;"></div>
  </div>
</div>

<script>
  const stages = 4;
  let completed = 0;

  function updateProgress() {
    completed = document.querySelectorAll('.section.completed').length;
    const percent = Math.round((completed / stages) * 100);
    document.getElementById('progressBar').style.width = percent + '%';
    document.getElementById('status').textContent = `进度：${percent}%（已完成${completed}/${stages}阶段）`;
  }

  function start() {
    if (!document.getElementById('promise').checked) {
      alert('请先勾选承诺');
      return;
    }
    document.getElementById('section0').style.display = 'none';
    document.getElementById('section1').style.display = 'block';
    scrollTo('section1');
    saveData(); // 初始保存
  }

  function completeStage(n) {
    document.getElementById(`section${n}`).classList.add('completed');
    const next = n + 1;
    if (next <= 3 || (next === 4 && !document.getElementById('quickMode').checked)) {
      document.getElementById(`section${next}`).style.display = 'block';
      scrollTo(`section${next}`);
    } else {
      document.getElementById('section4').style.display = 'block';
      scrollTo('section4');
      showPreview();
    }
    updateProgress();
    saveData();
  }

  function scrollTo(id) {
    document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function suggestAI(type) {
    let prompt = '';
    if (type === 1) prompt = `基于用户写的反向愿景草稿，帮我写得更具体、更痛苦（60–100字）：\n${document.getElementById('anti1').value || '(空，先帮我想一个最惨的健康场景)'}`;
    else if (type === 'root') prompt = `帮我挖掘拖延根源，给出“我在保护的旧身份”最可能的3种角色，并简短解释（每种20–30字）：`;
    else if (type === 'identity') prompt = `帮我把“我是谁”宣言润色得更坚定、具体、有力量（2–3句，每句20–40字）。用户草稿：${document.getElementById('new2').value || '(空，先给一个通用模板)'}。`;

    alert(`复制下面这段提示词 → 去Claude / GPT / 豆包 等模型生成，再粘贴回来：\n\n${prompt}`);
  }

  function showPreview() {
    let text = `重启日期：${document.getElementById('todayDate').value || new Date().toLocaleDateString('zh-CN')}\n\n`;
    text += `1. 反向愿景 & 根源\n${[
      '最惨状态：' + document.getElementById('anti1').value,
      '最孤独一天：' + document.getElementById('anti2').value,
      '保护的旧我：' + document.getElementById('root1').value
    ].filter(Boolean).join('\n')}\n\n`;
    text += `2. 新身份\n${[
      '自然小事：' + document.getElementById('new1').value,
      '我是谁：' + document.getElementById('new2').value,
      '真正想做：' + document.getElementById('new3').value
    ].filter(Boolean).join('\n')}\n\n`;
    text += `3. 计划\n${[
      '最重要一件事：' + document.getElementById('plan1').value,
      '每日仪式：' + document.getElementById('plan2').value,
      '强制机制：' + document.getElementById('plan3').value
    ].filter(Boolean).join('\n')}\n\n`;

    document.getElementById('preview').textContent = text;
  }

  function copyAll() {
    const text = document.getElementById('preview').textContent;
    navigator.clipboard.writeText(text).then(() => alert('已复制，可粘贴到笔记/文档'));
  }

  function exportImage() {
    html2canvas(document.querySelector('.container'), {scale: 2}).then(canvas => {
      const a = document.createElement('a');
      a.href = canvas.toDataURL('image/png');
      a.download = '重启记录-' + new Date().toISOString().slice(0,10) + '.png';
      a.click();
    });
  }

  function saveData() {
    const data = {};
    document.querySelectorAll('input, textarea').forEach(el => {
      data[el.id] = el.type === 'checkbox' ? el.checked : el.value;
    });
    localStorage.setItem('restart2026', JSON.stringify(data));
  }

  window.onload = () => {
    const saved = localStorage.getItem('restart2026');
    if (saved) {
      const data = JSON.parse(saved);
      Object.keys(data).forEach(k => {
        const el = document.getElementById(k);
        if (el) {
          if (el.type === 'checkbox') el.checked = data[k];
          else el.value = data[k];
        }
      });
      alert('已恢复上次进度，继续吧');
      updateProgress();
    }
  };

  // 每2分钟自动保存一次
  setInterval(saveData, 120000);
</script>
</body>
</html>
