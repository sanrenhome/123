<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>æ—§æˆ‘åˆ é™¤åè®® Â· 5åˆ†é’Ÿæµ‹ä½ 5å¹´åæœ‰å¤šæƒ¨</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --primary: #a78bfa; --primary-dark: #7c3aed;
      --accent: #d8b4fe; --danger: #f87171; --gold: #fcd34d;
      --bg: linear-gradient(135deg, #0f0f1a, #1e1b4b, #2a1a50);
      --card: rgba(25, 25, 55, 0.94);
      --text: #f0efff; --sub: #c4b5fd;
    }
    body {
      margin:0; font-family:system-ui, sans-serif;
      background:var(--bg); color:var(--text);
      min-height:100vh; padding:16px;
      display:flex; justify-content:center; align-items:flex-start;
    }
    #app { width:100%; max-width:420px; }
    .progress { height:8px; background:#2d2d4a; border-radius:4px; margin:16px 0; overflow:hidden; }
    .progress-bar { height:100%; width:0%; background:linear-gradient(90deg,var(--primary),var(--accent)); transition:width 0.5s ease; }
    .card {
      background:var(--card); border-radius:24px; padding:32px 20px;
      margin:16px 0; box-shadow:0 20px 50px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.05);
      border:1px solid #3a3a6e; display:none; opacity:0; transform:translateY(20px);
      transition:all 0.5s ease-out;
    }
    .card.active { display:block; opacity:1; transform:translateY(0); }
    h1 { font-size:2.4em; color:var(--accent); text-shadow:0 4px 16px rgba(167,139,250,0.5); text-align:center; margin-bottom:20px; }
    h2 { font-size:1.7em; color:var(--primary); margin:24px 0 16px; }
    .intro { font-size:1.1em; line-height:1.65; color:#d1d5ff; margin-bottom:20px; }
    .option-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin:20px 0; }
    .option {
      background:#1e1e38; border:2px solid #3a3a6e; border-radius:16px;
      padding:16px 12px; text-align:center; cursor:pointer; transition:all 0.3s;
      font-size:0.98em; position:relative;
    }
    .option:hover { transform:translateY(-4px); box-shadow:0 12px 28px rgba(139,92,246,0.3); border-color:var(--primary); }
    .option.selected { border-color:var(--primary); background:linear-gradient(135deg,rgba(167,139,250,0.2),rgba(216,180,254,0.1)); box-shadow:0 10px 24px rgba(167,139,250,0.35); }
    .option.selected::after { content:"âœ“"; position:absolute; top:8px; right:8px; background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.9em; }
    textarea { width:100%; padding:14px; margin:16px 0; border-radius:12px; border:1px solid #444; background:#141426; color:white; font-size:1em; min-height:80px; resize:vertical; }
    button {
      background:linear-gradient(135deg,var(--primary-dark),var(--primary));
      color:white; border:none; padding:16px; font-size:1.1em; border-radius:999px;
      width:100%; margin:20px 0 12px; cursor:pointer; box-shadow:0 8px 24px rgba(124,58,237,0.5);
      transition:all 0.3s;
    }
    button:hover { transform:translateY(-2px); box-shadow:0 12px 32px rgba(124,58,237,0.6); }
    #certificate {
      background:linear-gradient(145deg,#1e1e3f,#2a1a4a,#3a2a70);
      padding:40px 24px; border-radius:28px; border:4px dashed var(--accent);
      text-align:center; position:relative; overflow:hidden; margin:24px 0;
      box-shadow:0 20px 60px rgba(124,58,237,0.5), inset 0 0 30px rgba(216,180,254,0.15);
    }
    #cert-title { font-size:2.2em; color:var(--gold); text-shadow:0 4px 16px rgba(252,211,77,0.6); margin-bottom:24px; }
    .code-big { font-size:3.8em; font-weight:900; letter-spacing:10px; color:var(--accent); text-shadow:0 6px 24px rgba(216,180,254,0.7); margin:20px 0; }
    .rarity { font-size:1.4em; color:var(--gold); margin:12px 0; font-weight:bold; }
    .tag { display:inline-block; background:rgba(216,180,254,0.18); color:#e9d5ff; padding:8px 18px; border-radius:999px; margin:8px 6px; border:1px solid var(--accent); box-shadow:0 4px 12px rgba(216,180,254,0.25); }
    .watermark { font-size:0.9em; color:#777; margin-top:40px; opacity:0.8; }
    #shareText { width:100%; height:120px; margin:16px 0; padding:16px; background:#1a1a30; color:#e0e0ff; border:1px solid #555; border-radius:16px; font-size:0.98em; resize:none; }
  </style>
</head>
<body>

<div id="app">
  <div class="progress"><div class="progress-bar" id="progressBar"></div></div>

  <!-- å±1 å¼€åœº -->
  <div class="card active" id="page1">
    <h1>æ—§æˆ‘åˆ é™¤åè®®</h1>
    <p class="intro">ä½ ä¸æ˜¯æ‡’ï¼Œä½ åªæ˜¯å¤ªçˆ±é‚£ä¸ªè™½ç„¶ç—›è‹¦ä½†ç†Ÿæ‚‰çš„è‡ªå·±äº†ã€‚</p>
    <p class="intro" style="color:#ff9999; font-weight:bold;">5åˆ†é’Ÿåï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°è‡ªå·±5å¹´åæœ€ä¸æƒ³æˆä¸ºçš„æ ·å­â€¦â€¦</p>
    <p class="intro">æ•¢ç»§ç»­å—ï¼Ÿ</p>
    <button onclick="nextPage(2)">æ•¢ â†’ å¼€å§‹</button>
  </div>

  <!-- å±2 åå‘æ„¿æ™¯ï¼ˆç‹ é€‰é¡¹ï¼‰ -->
  <div class="card" id="page2">
    <h2>çœ‹è§5å¹´åæœ€æƒ¨çš„ä½ </h2>
    <p class="intro">é€‰å‡ºæœ€è®©ä½ è„ŠèƒŒå‘å‡‰çš„ç”»é¢ï¼ˆå¤šé€‰ï¼‰ï¼Œè¶Šå…·ä½“è¶Šç—›è¶ŠçœŸå®ã€‚</p>
    <div class="option-grid">
      <div class="option" data-value="æ¯å¤©åˆ·æ‰‹æœºåˆ°å‡Œæ™¨3ç‚¹ï¼Œç¬¬äºŒå¤©ç»§ç»­é‡å¤">æ¯å¤©åˆ·æ‰‹æœºåˆ°å‡Œæ™¨3ç‚¹ï¼Œç¬¬äºŒå¤©ç»§ç»­é‡å¤</div>
      <div class="option" data-value="å·¥èµ„åˆšå¤Ÿæˆ¿ç§Ÿï¼Œæ¢¦æƒ³æ—©è¢«ç”Ÿæ´»ç£¨å¹³">å·¥èµ„åˆšå¤Ÿæˆ¿ç§Ÿï¼Œæ¢¦æƒ³æ—©è¢«ç”Ÿæ´»ç£¨å¹³</div>
      <div class="option" data-value="æœ‹å‹åœˆå…¨æ˜¯åˆ«äººç»“å©šç”Ÿå­ä¹°æˆ¿ï¼Œä½ åœ¨ç‚¹èµ">æœ‹å‹åœˆå…¨æ˜¯åˆ«äººç»“å©šç”Ÿå­ä¹°æˆ¿ï¼Œä½ åœ¨ç‚¹èµ</div>
      <div class="option" data-value="èº«ä½“å‘ç¦ã€è„±å‘ã€è…°é…¸èƒŒç—›ï¼Œå´æ‡’å¾—åŠ¨">èº«ä½“å‘ç¦ã€è„±å‘ã€è…°é…¸èƒŒç—›ï¼Œå´æ‡’å¾—åŠ¨</div>
      <div class="option" data-value="åå¹´åè¿˜åœ¨è¯´â€œæ˜å¹´å°±åŠªåŠ›äº†â€">åå¹´åè¿˜åœ¨è¯´â€œæ˜å¹´å°±åŠªåŠ›äº†â€</div>
      <div class="option" data-value="æœ€äº²è¿‘çš„äººéƒ½çœ‹å¾—å‡ºä½ ä¸å¼€å¿ƒï¼Œä½ å´è¯´â€œæˆ‘æŒºå¥½çš„â€">æœ€äº²è¿‘çš„äººéƒ½çœ‹å¾—å‡ºä½ ä¸å¼€å¿ƒï¼Œä½ å´è¯´â€œæˆ‘æŒºå¥½çš„â€</div>
      <div class="option" data-value="æ‰åçƒ‚åœ¨æŠ–éŸ³è¯„è®ºåŒºå’Œæ— æ•ˆå†…è€—é‡Œ">æ‰åçƒ‚åœ¨æŠ–éŸ³è¯„è®ºåŒºå’Œæ— æ•ˆå†…è€—é‡Œ</div>
      <div class="option" data-value="çˆ¶æ¯é—®ä½ è¿‡å¾—æ€ä¹ˆæ ·ï¼Œä½ åªèƒ½è‹¦ç¬‘">çˆ¶æ¯é—®ä½ è¿‡å¾—æ€ä¹ˆæ ·ï¼Œä½ åªèƒ½è‹¦ç¬‘</div>
      <div class="option" data-value="æ·±å¤œemoåˆ°å“­ï¼Œå´ä¸çŸ¥é“ä¸ºè°å“­">æ·±å¤œemoåˆ°å“­ï¼Œå´ä¸çŸ¥é“ä¸ºè°å“­</div>
      <div class="option" data-value="é•œå­é‡Œçš„è‡ªå·±è¶Šæ¥è¶Šé™Œç”Ÿï¼Œè¶Šæ¥è¶Šåƒè‡ªå·±æœ€è®¨åŒçš„æ ·å­">é•œå­é‡Œçš„è‡ªå·±è¶Šæ¥è¶Šé™Œç”Ÿï¼Œè¶Šæ¥è¶Šåƒè‡ªå·±æœ€è®¨åŒçš„æ ·å­</div>
    </div>
    <textarea id="anti-custom" placeholder="æœ€è®©ä½ å®³æ€•çš„ä¸€å¥è¯ï¼ˆé€‰å¡«ï¼Œæ¯”å¦‚â€œæ—©çŸ¥é“å½“æ—¶å°±â€¦â€¦â€ï¼‰"></textarea>
    <button onclick="nextPage(3)">æˆ‘çœ‹è§äº† â†’ ç»§ç»­</button>
  </div>

  <!-- å±3 æ–°ç”Ÿä»£ç ï¼ˆ5ç»´åº¦ï¼‰ -->
  <div class="card" id="page3">
    <h2>é€‰æ‹©ä½ çš„æ–°ç”Ÿä»£ç </h2>
    <p class="intro">æ¯ä¸ªç»´åº¦é€‰æœ€çœŸå®çš„ä½ ï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸“å±ä»£ç  + ç¨€æœ‰åº¦</p>

    <h3>A - è§‰é†’åº¦</h3>
    <div class="option-grid">
      <div class="option" data-axis="A" data-value="A">ä¸»åŠ¨è§‰é†’è€…</div>
      <div class="option" data-axis="A" data-value="a">è¢«åŠ¨éº»æœ¨è€…</div>
      <div class="option" data-axis="A" data-value="p">ä¼ªè§‰é†’è€…</div>
    </div>

    <h3>C - åˆ›é€ åº¦</h3>
    <div class="option-grid">
      <div class="option" data-axis="C" data-value="C">ä»·å€¼åˆ›é€ è€…</div>
      <div class="option" data-axis="C" data-value="c">è¢«åŠ¨æ¶ˆè´¹è€…</div>
      <div class="option" data-axis="C" data-value="d">ç ´åå¼æ¶ˆè€—è€…</div>
    </div>

    <h3>V - ä»·å€¼å‘</h3>
    <div class="option-grid">
      <div class="option" data-axis="V" data-value="V">é•¿æœŸä»·å€¼å¯¼å‘</div>
      <div class="option" data-axis="V" data-value="v">çŸ­æœŸèˆ’é€‚å¯¼å‘</div>
      <div class="option" data-axis="V" data-value="h">äº«ä¹å³æ—¶å¯¼å‘</div>
    </div>

    <h3>E - æ‰©å±•åº¦</h3>
    <div class="option-grid">
      <div class="option" data-axis="E" data-value="E">ä¸»åŠ¨æ‰©å±•è€…</div>
      <div class="option" data-axis="E" data-value="e">é˜²å¾¡æ”¶ç¼©è€…</div>
      <div class="option" data-axis="E" data-value="s">å®‰å…¨åŒºå®ˆæŠ¤è€…</div>
    </div>

    <h3>T - æ—¶é—´è§‚</h3>
    <div class="option-grid">
      <div class="option" data-axis="T" data-value="T">æ°¸æ’ä¸»ä¹‰è€…</div>
      <div class="option" data-axis="T" data-value="t">å³æ—¶ä¸»ä¹‰è€…</div>
      <div class="option" data-axis="T" data-value="b">å¹³è¡¡ä¸»ä¹‰è€…</div>
    </div>

    <input type="text" id="nickname" placeholder="ä½ çš„æ–°ç”Ÿæ˜µç§°ï¼ˆé€‰å¡«ï¼‰" style="width:100%; padding:16px; margin:24px 0; border-radius:16px; border:1px solid #555; background:#1a1a2e; color:white; font-size:1.1em;"/>

    <button onclick="nextPage(4)">ç”Ÿæˆæˆ‘çš„æ–°ç”Ÿä»£ç  â†’</button>
  </div>

  <!-- å±4 è¯ä¹¦ + ç²’å­ -->
  <div class="card" id="page4">
    <h2>æ–°ç”Ÿå·²æ¿€æ´» âœ¨</h2>
    <div id="certificate">
      <div id="cert-title">æ—§æˆ‘åˆ é™¤åè®® Â· æ°¸ä¹…ç”Ÿæ•ˆ</div>
      <p id="cert-nick" style="font-size:1.9em; margin:20px 0;"></p>
      <div class="code-big" id="code-display"></div>
      <div class="rarity" id="rarity-text"></div>
      <div id="desc-text" style="font-size:1.25em; line-height:1.7; margin:20px 0;"></div>
      <div id="tags-container" style="margin:24px 0;"></div>
      <p id="cert-date" style="margin:32px 0; font-size:1.1em;"></p>
      <p class="watermark">ç”±ã€Œæ—§æˆ‘åˆ é™¤åè®®ã€ç”Ÿæˆ Â· 2026é‡å¯è§è¯</p>
    </div>

    <select id="shareStyle" style="width:100%; padding:14px; margin:16px 0; border-radius:16px; background:#1a1a30; color:white; border:1px solid #555;">
      <option value="0">æ¸©æŸ”å…±é¸£ç‰ˆ</option>
      <option value="1">ç‹ æˆ³ç—›ç‚¹ç‰ˆ</option>
      <option value="2">å‡¡å°”èµ›ç‚«è€€ç‰ˆ</option>
    </select>

    <textarea id="shareText" rows="6"></textarea>

    <button onclick="saveCertificate()">ä¿å­˜è¯ä¹¦é•¿å›¾ï¼ˆé•¿æŒ‰åˆ†äº«æœ‹å‹åœˆï¼‰</button>
    <button onclick="restart()" style="background:#4b5563; margin-top:12px;">é‡æ–°å¼€å§‹</button>
  </div>
</div>

<script>
  let currentPage = 1;
  const totalPages = 4;
  const progress = document.getElementById('progressBar');

  function updateProgress() {
    progress.style.width = (currentPage / totalPages * 100) + '%';
  }

  function nextPage(n) {
    document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
    document.getElementById(`page${n}`).classList.add('active');
    currentPage = n;
    updateProgress();
    if (n === 4) {
      generateResult();
      launchBigConfetti();
    }
  }

  function launchBigConfetti() {
    const duration = 5000;
    const end = Date.now() + duration;
    const colors = ['#a78bfa','#d8b4fe','#c4b5fd','#7c3aed','#fcd34d','#ffffff'];

    (function frame() {
      confetti({ particleCount: 8, angle: 60, spread: 70, origin: { x: 0 }, colors });
      confetti({ particleCount: 8, angle: 120, spread: 70, origin: { x: 1 }, colors });
      if (Date.now() < end) requestAnimationFrame(frame);
    }());
  }

  function generateResult() {
    const nick = document.getElementById('nickname').value.trim() || "æ–°ç”Ÿè§‰é†’è€…";
    const dateStr = new Date().toLocaleDateString('zh-CN', {year:'numeric',month:'long',day:'numeric'});

    document.getElementById('cert-nick').textContent = nick;
    document.getElementById('cert-date').textContent = `æ¿€æ´»æ—¥æœŸï¼š${dateStr}`;

    // ä»£ç ç”Ÿæˆ
    const axes = {};
    document.querySelectorAll('#page3 .option.selected').forEach(opt => {
      if (opt.dataset.axis) axes[opt.dataset.axis] = opt.dataset.value;
    });

    const code = (axes.A || 'A') + (axes.C || 'C') + (axes.V || 'V') + (axes.E || 'E') + (axes.T || 'T');
    document.getElementById('code-display').textContent = code;

    // ç¨€æœ‰åº¦ï¼ˆç®€å•æ¦‚ç‡ï¼‰
    const rarityRoll = Math.random();
    let rarity = "æ™®é€š";
    let rarityColor = "#aaaaaa";
    if (rarityRoll < 0.05) { rarity = "ä¼ è¯´çº§"; rarityColor = "#fcd34d"; }
    else if (rarityRoll < 0.15) { rarity = "å²è¯—çº§"; rarityColor = "#c084fc"; }
    else if (rarityRoll < 0.35) { rarity = "ç¨€æœ‰"; rarityColor = "#60a5fa"; }
    document.getElementById('rarity-text').textContent = rarity;
    document.getElementById('rarity-text').style.color = rarityColor;

    // æè¿°ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…å¯æ‰©å±•æˆå®Œæ•´æ¨¡æ¿ï¼‰
    const desc = `ä½ æ˜¯${rarity}çš„${code}å‹äººæ ¼ã€‚<br>ä½ æ­£åœ¨ä»éº»æœ¨çš„å¾ªç¯ä¸­å½»åº•æ’•å¼€å‡ºå£ï¼Œèµ°å‘ä»·å€¼åˆ›é€ ä¸é•¿æœŸæ‰©å±•çš„é“è·¯ã€‚<br>2026å¹´ï¼Œä½ å°†ä¸å†åŸè°…â€œæ˜å¹´å†åŠªåŠ›â€ã€‚`;
    document.getElementById('desc-text').innerHTML = desc;

    // æ ‡ç­¾
    const tagsContainer = document.getElementById('tags-container');
    tagsContainer.innerHTML = '';
    [rarity, code + 'å‹', 'æ—§æˆ‘å·²åˆ æ¡£', '2026é‡å¯ä¸­'].forEach(t => {
      const span = document.createElement('span');
      span.className = 'tag';
      span.textContent = t;
      tagsContainer.appendChild(span);
    });

    // åˆ†äº«æ–‡æ¡ˆ
    const style = document.getElementById('shareStyle').value;
    let txt = '';
    if (style === '0') {
      txt = `ä»Šå¤©åšäº†ã€Œæ—§æˆ‘åˆ é™¤åè®®ã€ï¼Œç¬¬ä¸€æ¬¡æ•¢ç›´é¢5å¹´åæœ€æƒ¨çš„è‡ªå·±â€¦â€¦\nç»“æœæ–°ç”Ÿä»£ç æ˜¯ ${code}ï¼ˆ${rarity}ï¼‰\næ„Ÿè§‰ç»ˆäºå¯ä»¥å’Œè¿‡å»çš„loserè¯´å†è§äº†ã€‚\nä½ ä¹Ÿæ¥è¯•è¯•ï¼Ÿæˆ–è®¸5åˆ†é’Ÿï¼Œå°±èƒ½æ”¹å˜è½¨è¿¹ã€‚\n${location.href}`;
    } else if (style === '1') {
      txt = `æˆ‘æ‰¿è®¤ï¼Œæˆ‘ä¸€ç›´åœ¨ä¿æŠ¤é‚£ä¸ªåºŸç‰©è‡ªå·±ã€‚\nå†™å®Œåå‘æ„¿æ™¯æƒ³åï¼Œä½†ä»£ç å‡ºæ¥åï¼Œæˆ‘çŸ¥é“æœ‰æ•‘äº†ã€‚\næ–°ç”Ÿä»£ç ï¼š${code}ï¼ˆ${rarity}ï¼‰\nä»ä»Šå¤©èµ·ï¼Œä¸å†ç»™è‡ªå·±æ‰¾å€Ÿå£ã€‚\nä½ æ•¢æµ‹å—ï¼Ÿ`;
    } else {
      txt = `æ–°ç”Ÿä»£ç åŠ è½½å®Œæˆï¼š${code}ï¼ˆ${rarity}ï¼‰âœ¨\næ—§æˆ‘å·²æ­»ï¼Œ2026ä»è¿™ä¸€åˆ»å¼€å§‹ä¸Šåˆ†ã€‚\nè°æ¥æŒ‘æˆ˜æˆ‘çš„ä¼ è¯´çº§ç¨€æœ‰åº¦ï¼ŸğŸ”¥\næµ‹ä¸€æµ‹ï¼š${location.href}`;
    }
    document.getElementById('shareText').value = txt;
  }

  function saveCertificate() {
    launchBigConfetti(); // ä¿å­˜å†çˆ†ä¸€æ¬¡
    const cert = document.getElementById('certificate');
    html2canvas(cert, {scale: 2.8, backgroundColor: null}).then(canvas => {
      const a = document.createElement('a');
      a.download = 'æ–°ç”Ÿç”»åƒ_æ—§æˆ‘åˆ é™¤åè®®.png';
      a.href = canvas.toDataURL('image/png');
      a.click();
      alert('é•¿å›¾å·²ç”Ÿæˆï¼é•¿æŒ‰ä¿å­˜ â†’ å‘æœ‹å‹åœˆè§è¯ä½ çš„æ–°ç”Ÿï½');
    }).catch(e => alert('ç”Ÿæˆå¤±è´¥ï¼š' + e.message + '\nè¯·å°è¯•æˆªå±'));
  }

  function restart() {
    document.querySelectorAll('input, textarea').forEach(el => el.value = '');
    document.querySelectorAll('.option').forEach(el => el.classList.remove('selected'));
    nextPage(1);
  }

  document.querySelectorAll('.option').forEach(opt => {
    opt.addEventListener('click', () => {
      const axis = opt.dataset.axis;
      if (axis) {
        document.querySelectorAll(`[data-axis="${axis}"]`).forEach(o => o.classList.remove('selected'));
      }
      opt.classList.toggle('selected');
    });
  });

  updateProgress();
</script>
</body>
</html>
